{% extends "pages//base.html" %}

{% block body_content %}



    <!-- Send Message - Modal -->
    <div class="modal fade" id="confirmWriteMessageModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Nowa wiadomość</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
			<form action="#" method="post">
				<div class="modal-body" id="idMessageModalBody">
					{{ form.csrf_token }}
						<div class="form-group">
							<label class="form-label"> {{ form.receiverEmail.label }} </label>
							{{ form.receiverEmail(class="form-select") }}
							<ul>
								{% for error in form.receiverEmail.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ form.subject.label }} </label>
							{{ form.subject(class="form-control") }}
							<ul>
								{% for error in form.subject.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ form.message.label }} </label>
							{{ form.message(class="form-control") }}
							<ul>
								{% for error in form.message.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ form.sendByApp.label }} </label>
							{{ form.sendByApp(class_="form-check-input", id="checkboxAppId") }}
							<ul>
								{% for error in form.sendByApp.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ form.sendByEmail.label }} </label>
							{{ form.sendByEmail(class_="form-check-input", id="checkboxEmailId") }}
							<ul>
								{% for error in form.sendByEmail.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>
				</div>
				<div class="modal-footer">
					<form method="GET" id="confirmWriteMessageForm">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
						<button type="submit" class="btn btn-dark" style="background-color: #182c07e8;" id="sendButtonId">Wyślij wiadomość</button>
					</form>
				</div>
			</form>
        </div>
        </div>
    </div>




	 <!-- READ Message - Modal -->
	 <div class="modal fade" id="readMessageModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Treść wiadomości</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
			<form action="#" method="post">
				<div class="modal-body" id="idReadMessageModalBody">
					{{ readForm.csrf_token }}
						<div class="form-group">
							<label class="form-label"> Nadawca </label>
							{{ readForm.sender(class="form-control") }}
							<ul>
								{% for error in readForm.sender.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ readForm.subject.label }} </label>
							{{ readForm.subject(class="form-control") }}
							<ul>
								{% for error in readForm.subject.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>

						<div class="form-group">
							<label class="form-label"> {{ readForm.message.label }} </label>
							{{ readForm.message(class="form-control") }}
							<ul>
								{% for error in readForm.message.errors %}
									{{ error }}
								{% endfor %}
							</ul>
						</div>					
				</div>
				<div class="modal-footer">
					<form method="GET" id="confirmReadMessage">
						<button type="button" class="btn btn-dark" style="background-color: #182c07e8;" data-bs-dismiss="modal">Zamknij</button>
					</form>
				</div>
			</form>
        </div>
        </div>
    </div>







    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script> 
		//Write Message
        $(document).ready(function () { 
            // For a write and sent new message
            // This function is applied to all elements with class ending with ".writeAndSendMessage 
            $('.writeAndSendMessageConfirm').click(function () { 
                // get attributes of the found element 
                var desc = $(this).attr('data-desc'); 
                var url = $(this).attr('data-url'); 
                // the #... designates id of an element - change the text in the modal window 
                $('#idMessageModalBody').text(desc); 
                $("#confirmWriteMessageForm").attr("action", url); 
            }); 
        }); 
    </script>


	<script>
		//Read Message
		$(document).ready(function () { 
			// For a write and sent new message
			// This function is applied to all elements with class ending with ".writeAndSendMessage 
			$('.readMessageConfirm').click(function () { 
				// get attributes of the found element 
				var desc = $(this).attr('data-desc'); 
				var url = $(this).attr('data-url'); 
				// the #... designates id of an element - change the text in the modal window 
				$('#idReadMessageModalBody').text(desc); 
				$("#confirmReadMessage").attr("action", url); 
			}); 
		}); 
	</script>

	<script>
		// Checking of checkboxes
		$("#idMessageModalBody").change(function() {
			if($("#checkboxAppId").prop('checked') || $("#checkboxEmailId").prop('checked')) {
				$("#sendButtonId").attr("disabled", false);
			} else {
				$("#sendButtonId").attr("disabled", true);
			}
    	});
	</script>


<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container">
<div class="row">
	<!-- BEGIN INBOX -->
	<div class="col-md-12">
		<div class="grid email">
			<div class="grid-body">
				<div class="row">
					<!-- BEGIN INBOX MENU -->
					<div class="col-md-3">
						<h2 class="grid-title"><i class="fa fa-inbox"></i> Wiadomości</h2>


						<!-- Button trigger modal -->
						<a type="button" class="btn btn-dark btn-lg writeAndSendMessageConfirm" 
							data-bs-toggle="modal" data-bs-target="#confirmWriteMessageModal"
							data-url="{{ url_for('other.mailbox', actionName=actionName) }}">
							<i class="fa fa-pencil"></i>&nbsp;&nbsp;Nowa wiadomość
						</a>

						<hr>

						<div class="katalogi">
							<ul class="nav nav-pills nav-stacked">
								<li class="header">Katalogi</li>
								<li class="{{ 'active' if actionName=='inbox' }}"><a href="{{ url_for('other.mailbox', actionName='inbox') }}"><i class="fa fa-inbox"></i> Odebrane ({{ amountOfReceivedMessages}})</a></li>
								<li><a href="#"><i class="fa fa-star"></i> Oznaczone gwiazdką</a></li>
								<li><a href="#"><i class="fa fa-bookmark"></i> Ważne</a></li>
								<li class="{{ 'active' if actionName=='sent' }}"><a href="{{ url_for('other.mailbox', actionName='sent') }}"><i class="fa fa-mail-forward"></i> Wysłane ({{ amountOfSentMessages }})</a></li>
								<li><a href="#"><i class="fa fa-folder"></i> Kosz</a></li>
							</ul>

						</div>
					</div>
					<!-- END INBOX MENU -->
					
					<!-- BEGIN INBOX CONTENT -->
					<div class="col-md-9">
						<div class="row">
							<div class="col-sm-6">
								<label style="margin-right: 8px;" class="">
									<div class="icheckbox_square-blue" style="position: relative;"><input type="checkbox" id="check-all" class="icheck" style="position: absolute; top: -20%; left: -20%; display: block; width: 140%; height: 140%; margin: 0px; padding: 0px; border: 0px; opacity: 0; background: rgb(255, 255, 255);"><ins class="iCheck-helper" style="position: absolute; top: -20%; left: -20%; display: block; width: 140%; height: 140%; margin: 0px; padding: 0px; border: 0px; opacity: 0; background: rgb(255, 255, 255);"></ins></div>
								</label>
								<div class="btn-group">
									<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
										Akcję <span class="caret"></span>
									</button>
									<ul class="dropdown-menu" role="menu">
										<li><a href="#">Mark as read</a></li>
										<li><a href="#">Mark as unread</a></li>
										<li><a href="#">Mark as important</a></li>
										<li class="divider"></li>
										<li><a href="#">Report spam</a></li>
										<li><a href="#">Delete</a></li>
									</ul>
								</div>
							</div>

							<div class="col-md-6 search-form">
								<form action="#" class="text-right">
									<div class="input-group">
										<input type="text" class="form-control input-sm" placeholder="Szukaj">
										<span class="input-group-btn">
                                            <button type="submit" name="search" class="btn_ btn-primary btn-sm search"><i class="fa fa-search"></i></button></span>
									</div>			 
								</form>
							</div>
						</div>
						
						<div class="padding"></div>
						
						<div class="table-responsive">
							<table class="table">
								<tbody>
									{% for message in messagesCurrentUser: %}

									<tr class="listOfMessages readMessageConfirm" 
										data-bs-toggle="modal" data-bs-target="#readMessageModal"
										data-desc="{{ message.message }}"
										data-url="{{ url_for('other.mailbox', actionName=actionName) }}">

									
										<td class="action"><input type="checkbox" /></td>
										<td class="action"><i class="fa fa-star-o"></i></td>
										<td class="action"><i class="fa fa-bookmark-o"></i></td>
										{% if actionName=='inbox': %}
											<td class="name"><a href="#" style="font-weight: 400;">{{ message.sender }}</a></td>
										{% else %}
											<td class="name"><a href="#">{{ message.receiver }}</a></td>
										{% endif %}
										<td class="subject"><a href="#">{{ message.subject }}</a></td>
										<td class="time">{{ message.date }}</td>
									</tr>
									
									{% endfor %}
								</tbody>
							</table>
						</div>

						<ul class="pagination">
							<li class="disabled"><a href="#">«</a></li>
							<li class="active"><a href="#">1</a></li>
							<li><a href="#">2</a></li>
							<li><a href="#">3</a></li>
							<li><a href="#">4</a></li>
							<li><a href="#">5</a></li>
							<li><a href="#">»</a></li>
						</ul>						
					</div>
					<!-- END INBOX CONTENT -->
					
				</div>
			</div>
		</div>
	</div>
	<!-- END INBOX -->
</div>
</div>

{% endblock %}